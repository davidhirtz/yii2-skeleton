$(function(){function o(t){var e=$(t.data("target")),n=t.data("ajax");$.ajax({url:t.attr("href"),method:t.data("method")||"post",params:t.data("params"),success:function(t){e.length&&("remove"===n?e.remove():"success"===n?e.toggleClass("bg-success"):"select"===n?e.toggleClass("is-selected"):"replace"===n&&(e.html(t),Skeleton.initContent(e)))}})}$.expr[":"].contains=$.expr.createPseudo(function(e){return function(t){return 0<=$(t).text().toUpperCase().indexOf(e.toUpperCase())}}),yii.confirm=function(t,e,n){var a=$(this);bootbox.confirm(t,function(t){t?a.data("ajax")?o(a):e&&e():n&&n()})},$("[data-ajax]").click(function(t){var e=$(this);e.data("confirm")||($('[data-toggle="tooltip"]').tooltip("hide"),o($(e)),t.preventDefault())}),$("[data-form-toggle]").change(function(){var r=$(this),l=r.find("option:selected"),c=r.data("targets");c&&c.show().find("[data-form-toggle]").trigger("change"),c=$(),$.each(r.data("form-toggle"),function(t,e){var n,a=$.isArray(e[0])?e[0]:[e[0]],o=$.isArray(e[1])?e[1]:[e[1]],i=String(l.length?(e=String(a[0]).match(/^data-([\w-]+)/))?l.data(e[1]):r.val():r.prop("checked")?r.val():0);for(t=0;t<a.length;t++)if(String(a[t])===i){for(n=0;n<o.length;n++)c=c.add($(o[n].match(/^[.#]/)?o[n]:".field-"+o[n]).hide());break}}),r.data("targets",c),Skeleton.toggleHr()}).filter(":visible").trigger("change"),$("[data-form-target]").change(function(){var t,e=$(this),n=e.find("option:selected").data("value"),a=e.data("form-target");for($.isArray(n)||(n=[n]),$.isArray(a)||(a=[a]),t=0;t<a.length;t++)$(a[t].match(/^[.#]/)?a[t]:"#"+a[t]).each(function(){this[void 0!==this.value?"value":"innerHTML"]=n[t]});Skeleton.toggleHr()}).filter(":visible").trigger("change"),$.fn.dropdownFilter=function(){var t=$(this),a=t.find(".dropdown-filter"),o=a.parent().next().nextAll();t.on("shown.bs.dropdown",function(){a.focus()}),a.keyup(function(t){var e,n=a.val();o.show(),""!==n&&(o.not(':contains("'+n+'")').hide(),13===t.which&&(e=o.filter("a:visible").eq(0)).length&&(window.location.href=e.attr("href")))})},$(document).ajaxError(function(t,e){e=e.responseText;e&&bootbox.alert(e)}),Skeleton.initContent()});var Skeleton={initContent:function(t){t=$(t||"body");t.find('[data-toggle="tooltip"]').tooltip(),$.hasOwnProperty("timeago")&&t.find(".timeago").timeago(),this.hasJUI()&&t.find(".sortable").each(function(){var t=$(this);t.sortable({axis:"y",handle:".sortable-handle",helper:function(t,e){var n=e.children(),e=e.clone();return e.children().each(function(t){$(this).width(n.eq(t).outerWidth())}),e},update:function(){$.post(t.data("sort-url"),$(this).sortable("serialize"))}})})},replaceWithAjax:function(e,t){var n=this,a=$(e);t=$.extend({url:document.location.href},"string"==typeof t?{url:t}:t||{}),$.ajax(t).done(function(t){n.initContent(a.html($("<div>").html(t).find(e).html()))})},toggleHr:function(){$("hr").each(function(){var t=$(this);t.toggle(0<t.nextUntil("hr, .form-group-sticky").filter(":visible").length)})},hasJUI:function(){return $.hasOwnProperty("ui")},initSelection:function(t){var e=$(t).find("input[type=checkbox]").on("change",function(){var t=0<e.filter(":checked").length;$("#btn-selection").toggle(t).closest(".hidden-if-inactive").toggleClass("active",t)})},uploadProgress:function(t,e){e=parseInt(e.loaded/e.total*100,10);$("#progress").toggle(e<100).find(".bar").css("width",e+"%")}};