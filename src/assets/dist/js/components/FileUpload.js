import{a as d}from"../chunk-KKRCZ3SV.js";var y=document.querySelector('meta[name="csrf-token"]').getAttribute("content");window.customElements.get("file-upload")||window.customElements.define("file-upload",class extends HTMLElement{connectedCallback(){let i=this.querySelector('input[type="file"]');if(!i)return;let m=(this.dataset.target?document.querySelector(this.dataset.target):null)||document.body,c=this.querySelector("button"),r=this.dataset.chunkSize?parseInt(this.dataset.chunkSize):1024*1024*2,h=(e,t,n)=>{let s=new FormData,a=new Headers;if(a.set("X-CSRF-Token",y),t>0||n<e.size){let o=e.slice(t,n);s.append(i.name,new File([o],e.name,{type:e.type})),a.set("Content-Range",`bytes ${t}-${n-1}/${e.size}`)}else s.append(i.name,e);return fetch(this.dataset.url,{body:s,headers:a,method:"POST"})};i.addEventListener("change",async e=>{let t=e.target.files;if(t){c.disabled=!0;for(let n=0;n<t.length;n++){let s=t[n],a=Math.ceil(s.size/r);for(let o=0;o<a;o++){let u=o*r,p=Math.min(u+r,s.size);await h(s,u,p).then(l=>{l.status===200?l.text().then(f=>{d.swap(m,f,{swapStyle:"outerHTML",swapDelay:0,settleDelay:0,show:"top"},{select:this.dataset.target||void 0})}):l.ok||(alert(l.statusText),o=a)})}}c.disabled=!1}}),c.onclick=()=>i.click()}});
//# sourceMappingURL=FileUpload.js.map
