import{a as u}from"../chunk-KKRCZ3SV.js";var w=document.querySelector('meta[name="csrf-token"]').getAttribute("content");window.customElements.get("file-upload")||window.customElements.define("file-upload",class extends HTMLElement{connectedCallback(){let o=this.querySelector('input[type="file"]');if(!o)return;let h=(this.dataset.target?document.querySelector(this.dataset.target):null)||document.body,r=this.dataset.chunkSize?parseInt(this.dataset.chunkSize):1024*1024*2,m=(e,t,a)=>{let n=new FormData,s=new Headers;if(s.set("X-CSRF-Token",w),t>0||a<e.size){let i=e.slice(t,a);n.append(o.name,new File([i],e.name,{type:e.type})),s.set("Content-Range",`bytes ${t}-${a-1}/${e.size}`)}else n.append(o.name,e);return fetch(this.dataset.url,{body:n,headers:s,method:"POST"})};o.addEventListener("change",async e=>{let t=e.target.files;if(!t)return;let a;for(let n=0;n<t.length;n++){let s=t[n],i=Math.ceil(s.size/r);for(let c=0;c<i;c++){let d=c*r,p=Math.min(d+r,s.size);await m(s,d,p).then(l=>{l.status===200?l.text().then(f=>{u.swap(h,f,{swapStyle:"outerHTML",swapDelay:0,settleDelay:0,show:"top"},{select:this.dataset.target||void 0})}):l.ok||(alert(l.statusText),c=i)})}}a&&(window.location.href=a)})}});
//# sourceMappingURL=FileUpload.js.map
