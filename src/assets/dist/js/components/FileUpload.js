import{a as g}from"../chunk-JHLL5XS5.js";window.customElements.get("file-upload")||window.customElements.define("file-upload",class extends HTMLElement{connectedCallback(){let l=this.querySelector('input[type="file"]');if(!l)return;let m=(this.dataset.target?document.querySelector(this.dataset.target):null)||document.body,u=this.querySelector("button"),o=this.dataset.chunkSize?parseInt(this.dataset.chunkSize):1024*1024*2,y=o*3;l.addEventListener("change",async b=>{let n=b.target.files;if(!n)return;let h=0;for(let e=0;e<n.length;e++)h+=n[e].size;let s=h>y?document.createElement("progress"):null;s&&(s.className="progress",s.max=h,s.value=0,m.appendChild(s)),u.disabled=!0;for(let e=0;e<n.length;e++){let t=n[e],p=Math.ceil(t.size/o);for(let r=0;r<p;r++){let f=new FormData,c=new Headers,i=r*o,d=Math.min(i+o,t.size);if(i>0||d<t.size){let a=t.slice(i,d);f.append(l.name,new File([a],t.name,{type:t.type})),c.set("Content-Range",`bytes ${i}-${d-1}/${t.size}`)}else f.append(l.name,t);e<n.length-1&&c.set("Prefer","status=204"),c.set("X-CSRF-Token",Object.values(JSON.parse(document.querySelector("#wrap").getAttribute("hx-headers"))).pop()),await fetch(this.dataset.url,{body:f,headers:c,method:"POST"}).then(a=>{a.status===200?a.text().then(w=>{g.swap(m,w,{swapStyle:"outerHTML",swapDelay:0,settleDelay:0,show:"top"},{select:this.dataset.target||void 0})}):a.ok||(alert(a.statusText),r=p),s&&(s.value+=d-i)})}}u.disabled=!1}),u.onclick=()=>l.click()}});
//# sourceMappingURL=FileUpload.js.map
