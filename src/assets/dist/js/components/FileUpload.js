import{a as h}from"../chunk-KKRCZ3SV.js";var b=document.querySelector('meta[name="csrf-token"]').getAttribute("content");window.customElements.get("file-upload")||window.customElements.define("file-upload",class extends HTMLElement{connectedCallback(){let o=this.querySelector('input[type="file"]');if(!o)return;let m=(this.dataset.target?document.querySelector(this.dataset.target):null)||document.body,r=this.querySelector("button"),d=this.dataset.chunkSize?parseInt(this.dataset.chunkSize):1024*1024*2,f=(e,t,a)=>{let n=new FormData,s=new Headers;if(s.set("X-CSRF-Token",b),t>0||a<e.size){let i=e.slice(t,a);n.append(o.name,new File([i],e.name,{type:e.type})),s.set("Content-Range",`bytes ${t}-${a-1}/${e.size}`)}else n.append(o.name,e);return fetch(this.dataset.url,{body:n,headers:s,method:"POST"})};o.addEventListener("change",async e=>{let t=e.target.files;if(!t)return;r.disabled=!0;let a;for(let n=0;n<t.length;n++){let s=t[n],i=Math.ceil(s.size/d);for(let l=0;l<i;l++){let u=l*d,p=Math.min(u+d,s.size);await f(s,u,p).then(c=>{c.status===200?c.text().then(y=>{h.swap(m,y,{swapStyle:"outerHTML",swapDelay:0,settleDelay:0,show:"top"},{select:this.dataset.target||void 0})}):c.ok||(alert(c.statusText),l=i)})}}a&&(window.location.href=a),r.disabled=!1}),r.onclick=()=>o.click()}});
//# sourceMappingURL=FileUpload.js.map
